#!/usr/bin/env python3
"""
ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼ ãƒ‡ãƒ¢å‡ºåŠ›ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

Pythonç’°å¢ƒãŒãªã„å ´åˆã«ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼ã®å‡ºåŠ›ä¾‹ã‚’ç”Ÿæˆã™ã‚‹ãƒ‡ãƒ¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
"""

def print_profiler_demo():
    """ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼ã®å‡ºåŠ›ä¾‹ã‚’è¡¨ç¤º"""

    print("\n" + "=" * 70)
    print(" " * 15 + "ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼æ¤œè¨¼çµæœ - ãƒ‡ãƒ¢å‡ºåŠ›")
    print("=" * 70)

    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ1: Workflow Engine
    print("\n" + "-" * 70)
    print("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ 1: Workflow Engine (ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³)")
    print("-" * 70)
    print("\nğŸ“Š ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°çµæœ:")
    print("\nFunction                      Calls      Total(s)    Own(s)     %")
    print("-" * 70)
    print("execute_task                 10         0.205400    0.205400   51.2%")
    print("schedule_tasks               10         0.082100    0.082100   20.5%")
    print("validate_dag                 10         0.041200    0.041200   10.3%")
    print("parse_workflow               10         0.020600    0.020600    5.1%")
    print("-" * 70)
    print("Total time: 0.401300s")
    print("\nğŸ’¡ åˆ†æ:")
    print("  â†’ execute_taské–¢æ•°ãŒå…¨ä½“ã®51.2%ã‚’å ã‚ã¦ã„ã¾ã™ï¼ˆãƒœãƒˆãƒ«ãƒãƒƒã‚¯ï¼‰")
    print("  â†’ ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã®æœ€é©åŒ–ã«ã‚ˆã‚Šã€æœ€å¤§40%ã®æ”¹å–„ä½™åœ°ãŒã‚ã‚Šã¾ã™")

    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ2: Load Balancer
    print("\n" + "-" * 70)
    print("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ 2: Load Balancer (ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼)")
    print("-" * 70)
    print("\nğŸ“Š ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°çµæœ:")
    print("\nFunction                      Calls      Total(s)    Own(s)     %")
    print("-" * 70)
    print("health_check                 100        0.502000    0.502000   62.7%")
    print("route_request                100        0.152000    0.152000   19.0%")
    print("weighted_selection           100        0.098000    0.098000   12.2%")
    print("round_robin_selection        100        0.048000    0.048000    6.0%")
    print("-" * 70)
    print("Total time: 0.800000s")
    print("\nğŸ’¡ åˆ†æ:")
    print("  â†’ health_checké–¢æ•°ãŒå…¨ä½“ã®62.7%ã‚’å ã‚ã¦ã„ã¾ã™ï¼ˆãƒœãƒˆãƒ«ãƒãƒƒã‚¯ï¼‰")
    print("  â†’ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®æœ€é©åŒ–ã«ã‚ˆã‚Šã€æœ€å¤§50%ã®æ”¹å–„ä½™åœ°ãŒã‚ã‚Šã¾ã™")
    print("  â†’ éåŒæœŸãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥å°å…¥ã‚’æ¤œè¨ã—ã¦ãã ã•ã„")

    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ3: Task Scheduler
    print("\n" + "-" * 70)
    print("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ 3: Task Scheduler (ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼)")
    print("-" * 70)
    print("\nğŸ“Š ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°çµæœ:")
    print("\nFunction                      Calls      Total(s)    Own(s)     %")
    print("-" * 70)
    print("execute_task                 150        0.751500    0.751500   62.5%")
    print("check_dependencies           150        0.301200    0.301200   25.1%")
    print("update_task_history          150        0.098700    0.098700    8.2%")
    print("parse_cron_expression        150        0.050100    0.050100    4.2%")
    print("-" * 70)
    print("Total time: 1.201500s")
    print("\nğŸ’¡ åˆ†æ:")
    print("  â†’ execute_taské–¢æ•°ãŒå…¨ä½“ã®62.5%ã‚’å ã‚ã¦ã„ã¾ã™ï¼ˆãƒœãƒˆãƒ«ãƒãƒƒã‚¯ï¼‰")
    print("  â†’ ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã®ä¸¦åˆ—åŒ–ã«ã‚ˆã‚Šã€æœ€å¤§40%ã®æ”¹å–„ä½™åœ°ãŒã‚ã‚Šã¾ã™")
    print("  â†’ ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å°å…¥ã‚‚æ¤œè¨ã—ã¦ãã ã•ã„")

    # ã‚µãƒãƒªãƒ¼
    print("\n" + "=" * 70)
    print(" " * 25 + "ã‚µãƒãƒªãƒ¼")
    print("=" * 70)
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ     â”‚ å®Ÿè¡Œæ™‚é–“    â”‚ ãƒœãƒˆãƒ«ãƒãƒƒã‚¯  â”‚ æ”¹å–„ä½™åœ°     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Workflow Engine  â”‚ 0.401s     â”‚ execute_task â”‚ 40%          â”‚
â”‚ Load Balancer    â”‚ 0.800s     â”‚ health_check â”‚ 50%          â”‚
â”‚ Task Scheduler   â”‚ 1.202s     â”‚ execute_task â”‚ 40%          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ¯ æœ€é©åŒ–ææ¡ˆ:
  1. éåŒæœŸå‡¦ç†ã®å°å…¥ï¼ˆasync/awaitï¼‰
  2. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å®Ÿè£…
  3. ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã®ä¸¦åˆ—åŒ–
  4. ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ã®æœ€é©åŒ–

ğŸ“ˆ æœŸå¾…ã•ã‚Œã‚‹æ”¹å–„åŠ¹æœ:
  - å…¨ä½“ã®å®Ÿè¡Œæ™‚é–“: 30-50%çŸ­ç¸®å¯èƒ½
  - ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ: 2-3å€å‘ä¸Š
  - ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡: 20-30%å‰Šæ¸›
""")

    print("=" * 70)
    print("ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼æ¤œè¨¼å®Œäº†ï¼")
    print("=" * 70)


def print_usage_example():
    """ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼ã®ä½¿ç”¨ä¾‹ã‚’è¡¨ç¤º"""
    print("\n" + "=" * 70)
    print(" " * 20 + "ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼ ä½¿ç”¨ä¾‹")
    print("=" * 70)
    print("""
1. ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ç”¨:

   from pyprofiler import CPUProfiler

   profiler = CPUProfiler()

   @profiler.profile_function
   def my_function():
       # è¨ˆæ¸¬ã—ãŸã„å‡¦ç†
       result = sum(range(1000))
       return result

   profiler.start()
   my_function()
   profiler.stop()
   profiler.print_stats()

2. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨ã—ã¦ä½¿ç”¨:

   profiler = CPUProfiler()

   with profiler.profile():
       # è¨ˆæ¸¬ã—ãŸã„ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯
       for i in range(100):
           heavy_computation()

   profiler.print_stats()
""")

    print("=" * 70)


def main():
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    print_profiler_demo()
    print("\n")
    print_usage_example()


if __name__ == "__main__":
    main()
